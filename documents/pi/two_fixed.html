<html>
<body>

<canvas id="back" width = "2000" height = "5000"></canvas>

<script>

var hidden_width = 20000;
var canvas = document.getElementById('back');
var context = canvas.getContext('2d');
	
var set_back = function(){
	context.beginPath();
	context.rect(0,0,canvas.width,canvas.height);
	context.fillStyle='blue';
	context.fill();
};

set_back();
	
var squares = [];
for(var i=0;i<canvas.width/5;i++){squares[i]=i*5;};

var bools = [];
for(var i=0;i<hidden_width/5;i++){bools[i]=0;};//i%2;};
bools[hidden_width/10]=1;	// 5 for box size, 2 for middle

var reset = function(){
};

var update = function(){
	var temp = [];
	for(var i=0;i<bools.length;i++)
	{
		if(
			bools[(i+1)%bools.length]==1
			^ bools[(i-1)%bools.length]==1
		){temp[i]=1;}
		else{temp[i]=0;};
	}
	bools = temp;
};
	
var square = function(x,y){
	context.beginPath();
	context.rect(x,y,5,5);
	context.fillStyle='black';
	context.fill();
}

var render = function(count){
	for(var i=0;i<squares.length;i++){
		if(bools[i+(hidden_width-canvas.width)/10]){
			square(squares[i],count);
		};
	};
};

count=0;
var main = function(){
//	set_back();
	if(count<canvas.height)render(count);
	update();
	count+=5;
};

reset();
var then = Date.now();
setInterval(main,1);


</script>

</body>
</html>
